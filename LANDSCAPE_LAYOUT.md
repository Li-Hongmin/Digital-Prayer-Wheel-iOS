# 横屏布局实现说明

## 布局结构

```
┌────────────────────────────────────────────────────────┐
│              顶部标题 + 设置按钮                        │
├──────────────┬──────────────┬──────────────────────────┤
│              │              │                          │
│  普贤十大愿  │   转经筒     │   净业正因               │
│  (两列)      │   (居中)     │   (单列)                 │
│  1. 礼敬诸佛 │              │   1. 孝养父母...        │
│  2. 称赞如来 │   今日功德   │   2. 受持三归...        │
│  3. 广修供养 │              │   3. 发菩提心...        │
│  4. 忏悔业障 │   累计天数   │                          │
│  5. 随喜功德 │              │                          │
│              │              │                          │
│  6. 请转法轮 │              │                          │
│  7. 请佛住世 │              │                          │
│  8. 常随佛学 │              │                          │
│  9. 恒顺众生 │              │                          │
│  10.普皆回向│              │                          │
├──────────────┴──────────────┴──────────────────────────┤
│                   回向偈（独立横向两行）                │
│  愿以此功德。庄严佛净土。 上报四重恩。下济三途苦。    │
│  若有见闻者。悉发菩提心。 尽此一报身。同生极乐国。    │
└────────────────────────────────────────────────────────┘
```

## 实现细节

### 1. 整体结构（VStack）
```swift
VStack(spacing: 0) {
    // 顶部：标题栏
    // 中间：HStack 三栏
    // 底部：回向偈
}
```

### 2. 顶部标题栏
- 经文名称（居中）
- 装载信息（经文名称下方）
- 帮助和设置按钮（右上角）

### 3. 中间主体（HStack 三栏）

#### 左侧（30%）：普贤十大愿
- 使用 `BuddhistTeachingsView`
- 参数：`initiallyExpanded: true, twoColumnMode: true, onlyVows: true`
- 两列垂直显示（1-5 左列，6-10 右列）

#### 中间（40%）：转经筒 + 统计
- 转经筒（放大尺寸：200x200）
- 今日功德统计（可点击查看日历）
- 累计天数统计
- VStack 垂直布局

#### 右侧（30%）：净业正因
- 使用 `PureKarmaView`
- 参数：`initiallyExpanded: true`
- 单列垂直显示
- 三条净业正因，带分隔线

### 4. 底部回向偈
- 使用 `DedicationVerseView`
- 参数：`compactMode: true`
- 紧凑模式：横向两行显示
- 不可折叠（始终显示）
- 全宽显示

## 组件修改

### BuddhistTeachingsView.swift
**新增参数**：
- `twoColumnMode: Bool = false` - 启用两列模式
- `onlyVows: Bool = false` - 只显示普贤十大愿

**两列模式布局**：
```swift
HStack(alignment: .top) {
    VStack { // 左列 1-5 }
    VStack { // 右列 6-10 }
}
```

### PureKarmaView.swift
**修改**：
- 默认展开：`initiallyExpanded: Bool = true`
- 默认状态：`isExpanded: Bool = true`

### DedicationVerseView.swift
**新增参数**：
- `compactMode: Bool = false` - 紧凑模式（横屏底部）

**紧凑模式特点**：
- 无折叠功能
- 较小的标题和内容字体
- 固定展开状态
- 两行横向显示

## 触发条件

在 `iOSContentView.swift` 第 31 行：

```swift
if geometry.size.width > geometry.size.height {
    // 横屏：使用横屏布局
    iOSLandscapePrayerWheelView(...)
}
```

当设备宽度 > 高度时，自动切换到横屏布局。

## 响应式尺寸

所有尺寸使用 `ResponsiveScale` 自适应：
- 转经筒：200x200（横屏放大）
- 字体：根据屏幕大小自适应
- 间距：使用 `scale.size()` 统一缩放

## 交互功能

### 保留的功能
- ✅ 点击转经筒：开始/停止旋转
- ✅ 点击今日功德：打开日历统计
- ✅ 点击设置按钮：打开设置
- ✅ 点击帮助按钮：打开帮助

### 移除的功能（横屏）
- ❌ 牌位图标（左右牌位移除，节省空间）
- ❌ 佛学教导折叠（固定展开）

## 设计理念

### 空间利用
- 横屏空间充足，充分展示所有内容
- 左中右均分空间，视觉平衡
- 底部回向偈独立一行，不占用主体空间

### 视觉层次
1. **顶部**：经文名称（最显眼）
2. **中间**：转经筒（视觉中心）
3. **两侧**：佛学教导（辅助内容）
4. **底部**：回向偈（独立显示）

### 用户体验
- 一屏显示所有重要信息
- 无需滚动查看内容
- 转经筒居中，方便点击控制
- 统计信息紧邻转经筒，易于查看

## 测试建议

1. **旋转测试**
   - 竖屏 → 横屏：布局自动切换
   - 横屏 → 竖屏：恢复原布局

2. **内容显示**
   - 普贤十大愿：两列显示完整
   - 净业正因：单列显示完整
   - 回向偈：底部横向两行

3. **交互测试**
   - 点击转经筒：旋转控制正常
   - 点击今日功德：日历弹出正常
   - 所有按钮功能正常

## 未来优化建议

- [ ] 添加左右滑动手势切换经文
- [ ] 优化平板（iPad）的字体大小
- [ ] 支持 Dark Mode 颜色调整
- [ ] 添加横屏专属动画效果

---

**实现完成时间**: 2025-11-14
**文件修改**:
- iOSLandscapePrayerWheelView.swift（重构）
- BuddhistTeachingsView.swift（添加两列模式）
- DedicationVerseView.swift（添加紧凑模式）
- PureKarmaView.swift（默认展开）

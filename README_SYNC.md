# 数据同步功能说明

## 当前状态

✅ **应用可以直接使用**，无需任何配置

## 工作模式

### 默认模式（推荐）
- iOS 和 Watch 各自独立存储数据
- 两个设备的计数分开统计
- 不影响任何功能的正常使用

### 同步模式（可选，需要配置）
- iOS 和 Watch 共享数据
- 切换设备时数据自动同步
- 需要在 Xcode 中配置 App Group

## 如何启用同步（可选）

**前提条件**：
- ⚠️ 需要有效的 Apple Developer Account（可以是免费账号）
- ⚠️ 需要在真机上测试（模拟器可能不稳定）

**步骤**：

1. 确保 Xcode 中已添加 App Group capability（iOS 和 Watch 都需要）
2. Group ID 已经配置为：`group.com.li-hongmin.digital-prayer-wheel`
3. 编译并在真机上测试

**验证**：
- 运行应用后查看 Console 日志
- 如果看到 `✅ Shared UserDefaults initialized`，说明同步已启用
- 如果看到 `⚠️ App Group not configured`，说明使用本地存储模式

## 常见问题

### Q: 我必须配置同步吗？
**A**: ❌ 不需要。应用默认使用本地存储，完全可以正常使用。

### Q: 不配置会影响功能吗？
**A**: ❌ 不会。唯一的区别是 iOS 和 Watch 的数据是独立的。

### Q: 如何知道同步是否工作？
**A**:
1. 在 iPhone 上转经几圈
2. 打开 Watch 应用
3. 查看计数是否一致

### Q: 配置有问题怎么办？
**A**: 应用会自动降级到本地存储模式，不会崩溃或报错。

### Q: 免费 Apple ID 可以用吗？
**A**: ✅ 可以，但：
- 需要在真机上测试
- 可能会有一些警告（不影响功能）

## 技术细节

### 存储策略
- **本地存储**: `UserDefaults.standard`（始终保留）
- **共享存储**: `UserDefaults(suiteName: "group.com.li-hongmin.digital-prayer-wheel")`（可选）

### 数据合并
- 加载时：取本地和共享的最大值
- 保存时：同时保存到本地和共享存储
- 好处：永远不会丢失数据

### 降级机制
```
如果 App Group 配置成功 {
    使用共享存储 + 本地备份
} 否则 {
    仅使用本地存储
}
```

## 建议

- 🔰 **新用户**: 直接使用，无需配置
- 📱 **单设备用户**: 无需配置同步
- ⌚ **多设备用户**: 可以尝试配置同步
- 🚀 **技术用户**: 详见 `APP_GROUP_SETUP.md`

---

**总结**：应用现在可以直接使用，同步功能是**可选的增强功能**，不影响核心体验。
